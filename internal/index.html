<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Internal Documentation - TTCal</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Internal Documentation";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> TTCal</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Usage</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../gaincal/">Gain Calibration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../polcal/">Polarization Calibration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ampcal/">Amplitude Calibration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sources/">Sky Models</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developer Documentation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../external/">API</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Internal Documentation</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#internal-documentation">Internal Documentation</a></li>
                
                    <li><a class="toctree-l4" href="#constantbeam">ConstantBeam</a></li>
                
                    <li><a class="toctree-l4" href="#jonesmatrix">JonesMatrix</a></li>
                
                    <li><a class="toctree-l4" href="#memo178beam">Memo178Beam</a></li>
                
                    <li><a class="toctree-l4" href="#rkn">RK{N}</a></li>
                
                    <li><a class="toctree-l4" href="#sinebeam">SineBeam</a></li>
                
                    <li><a class="toctree-l4" href="#ampcal_step">ampcal_step</a></li>
                
                    <li><a class="toctree-l4" href="#dir2azel">dir2azel</a></li>
                
                    <li><a class="toctree-l4" href="#dir2lm">dir2lm</a></li>
                
                    <li><a class="toctree-l4" href="#dir2radec">dir2radec</a></li>
                
                    <li><a class="toctree-l4" href="#fixphase">fixphase!</a></li>
                
                    <li><a class="toctree-l4" href="#flag_short_baselines">flag_short_baselines!</a></li>
                
                    <li><a class="toctree-l4" href="#force_to_horizon">force_to_horizon</a></li>
                
                    <li><a class="toctree-l4" href="#fringepattern">fringepattern!</a></li>
                
                    <li><a class="toctree-l4" href="#gaincal_step">gaincal_step</a></li>
                
                    <li><a class="toctree-l4" href="#get_corrected_data">get_corrected_data</a></li>
                
                    <li><a class="toctree-l4" href="#get_flags">get_flags</a></li>
                
                    <li><a class="toctree-l4" href="#invert">invert</a></li>
                
                    <li><a class="toctree-l4" href="#latlong_to_utm">latlong_to_utm</a></li>
                
                    <li><a class="toctree-l4" href="#linear">linear</a></li>
                
                    <li><a class="toctree-l4" href="#mueller">mueller</a></li>
                
                    <li><a class="toctree-l4" href="#polcal_makesquare">polcal_makesquare</a></li>
                
                    <li><a class="toctree-l4" href="#polcal_step">polcal_step</a></li>
                
                    <li><a class="toctree-l4" href="#rkstep">rkstep</a></li>
                
                    <li><a class="toctree-l4" href="#scalar_makesquare">scalar_makesquare</a></li>
                
                    <li><a class="toctree-l4" href="#stokes">stokes</a></li>
                
                    <li><a class="toctree-l4" href="#utm_to_latlong">utm_to_latlong</a></li>
                
                    <li><a class="toctree-l4" href="#write_ds9_regions">write_ds9_regions</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../contributing/">Contributing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../docs/">Building this Website</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">TTCal</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Developer Documentation &raquo;</li>
        
      
    
    <li>Internal Documentation</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mweastwood/TTCal.jl" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <!---
This is an auto-generated file and should not be edited directly.
-->

<h2 id="internal-documentation">Internal Documentation</h2>
<h3 id="constantbeam">ConstantBeam</h3>
<pre><code>ConstantBeam &lt;: BeamModel
</code></pre>

<p>In this beam model, the Jones matrix is assumed to be unity in every direction.</p>
<h3 id="jonesmatrix">JonesMatrix</h3>
<p>This type represents a 2x2 complex Jones matrix.</p>
<pre><code>⌈xx xy⌉
⌊yx yy⌋
</code></pre>

<h3 id="memo178beam">Memo178Beam</h3>
<pre><code>Memo178Beam &lt;: BeamModel
</code></pre>

<p>This beam is based on the parametric fit to EM simulations presented in LWA memo 178 by Jayce Dowell.</p>
<p>[http://www.faculty.ece.vt.edu/swe/lwa/memo/lwa0178a.pdf]</p>
<h3 id="rkn">RK{N}</h3>
<p>This singleton type is used to indicate which Runge-Kutta method should be used. For example, <code>RK{4}</code> tells us to use the RK4 method.</p>
<h3 id="sinebeam">SineBeam</h3>
<pre><code>SineBeam &lt;: BeamModel
</code></pre>

<p>This beam is azimuthally symmetric and independent of frequency. The gain of an individual dipole scales as $\sin(elevation)^\alpha$.</p>
<h3 id="ampcal_step">ampcal_step</h3>
<pre><code>ampcal_step(amplitudes,data,model) -&gt; step
</code></pre>

<p>Given the <code>data</code> and <code>model</code> visibilities, and the current guess for the gain <code>amplitudes</code>, solve for <code>step</code> such that the new value of the amplitudes is <code>amplitudes+step</code>.</p>
<h3 id="dir2azel">dir2azel</h3>
<pre><code>dir2azel(frame::ReferenceFrame, dir::Direction)
</code></pre>

<p>Convert the direction into a local azimuth and elevation.</p>
<h3 id="dir2lm">dir2lm</h3>
<pre><code>dir2lm(phase_dir::Direction{dir&quot;J2000&quot;}, dir::Direction{dir&quot;J2000&quot;})
</code></pre>

<p>Convert the direction into the standard radio coordinate system.</p>
<h3 id="dir2radec">dir2radec</h3>
<pre><code>dir2radec(frame::ReferenceFrame, dir::Direction)
</code></pre>

<p>Convert the direction into a J2000 right ascension and declination.</p>
<h3 id="fixphase">fixphase!</h3>
<pre><code>fixphase!(cal::AmplitudeCalibration, reference_antenna)
</code></pre>

<p>With an amplitude calibration there is no freedom to pick an arbitrary phase, so this function does nothing.</p>
<pre><code>fixphase!(cal::GainCalibration, reference_antenna)
</code></pre>

<p>Set the phase of the reference antenna and polarization to zero.</p>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>cal</code> - the calibration that will have its phase adjusted</li>
<li><code>reference_antenna</code> - a string containing the antenna number and polarization     whose phase will be chosen to be zero (eg. "14y" or "62x")</li>
</ul>
<h3 id="flag_short_baselines">flag_short_baselines!</h3>
<pre><code>flag_short_baselines!(flags, minuvw, u, v, w, ν)
</code></pre>

<p>Flag all of the baselines whose length is less than <code>minuvw</code> wavelengths.</p>
<p>This is a common operation that can mitigate contamination by unmodeled diffuse emission.</p>
<h3 id="force_to_horizon">force_to_horizon</h3>
<pre><code>force_to_horizon(l,m)
</code></pre>

<p>This function forces the coordinates $(l,m)$ to be above the horizon.</p>
<p>Although this is a nasty hack, it is necessary for fitting some sources that are near the horizon.</p>
<h3 id="fringepattern">fringepattern!</h3>
<p>Compute exp(i(ϕ+nΔϕ)) where ϕ and Δϕ define an equally space grid of points where n = 1 to N.</p>
<p>Using the sine and cosine angle addition rules, you can define an iterative method such that you only need to compute sines and cosines for a single iteration.</p>
<h3 id="gaincal_step">gaincal_step</h3>
<pre><code>gaincal_step(gains,data,model) -&gt; step
</code></pre>

<p>Given the <code>data</code> and <code>model</code> visibilities, and the current guess for the electronic <code>gains</code>, solve for <code>step</code> such that the new value of the gains is <code>gains+step</code>.</p>
<p>The update step is defined such that the new value of the gains minimizes</p>
<p>[     \sum_{i,j}\|V_{i,j} - g_i g_{j,new}^* M_{i,j}\|^2$, ]</p>
<p>where $i$ and $j$ label the antennas, $V$ labels the measured visibilities, $M$ labels the model visibilities, and $g$ labels the complex gains.</p>
<p><em>References:</em></p>
<ul>
<li>Michell, D. et al. 2008, JSTSP, 2, 5.</li>
<li>Salvini, S. &amp; Wijnholds, S. 2014, A&amp;A, 571, 97.</li>
</ul>
<h3 id="get_corrected_data">get_corrected_data</h3>
<pre><code>get_corrected_data(ms::MeasurementSet)
</code></pre>

<p>Get the CORRECTED_DATA column if it exists. Otherwise settle for the DATA column.</p>
<h3 id="get_flags">get_flags</h3>
<pre><code>get_flags(ms::MeasurementSet)
</code></pre>

<p>Get the flags from the dataset, but this information is stored in multiple locations. Unify all these flags before returning.</p>
<h3 id="invert">invert</h3>
<pre><code>invert(cal::ScalarCalibration)
</code></pre>

<p>Returns the inverse of the given calibration. The gain $g$ of each antenna is set to $1/g$.</p>
<pre><code>invert(cal::PolarizationCalibration)
</code></pre>

<p>Returns the inverse of the given calibration. The Jones matrix $J$ of each antenna is set to $J^{-1}$.</p>
<h3 id="latlong_to_utm">latlong_to_utm</h3>
<pre><code>latlong_to_utm(zone, latitude, longitude)
</code></pre>

<p>Convert the latitude and longitude (both in degrees) to an easting and a northing (both in meters).</p>
<p>This function is entirely based on the <a href="https://en.wikipedia.org/w/index.php?title=Universal_Transverse_Mercator_coordinate_system&amp;oldid=683193579#Simplified_formulas">Universal Transverse Mercator coordinate system</a> Wikipedia page.</p>
<h3 id="linear">linear</h3>
<pre><code>linear(stokes) -&gt; [xx,xy,yx,yy]
</code></pre>

<p>Take the vector of Stokes parameters <code>[I,Q,U,V]</code> and convert it to the vector of linear correlations.</p>
<h3 id="mueller">mueller</h3>
<pre><code>mueller(J::JonesMatrix)
</code></pre>

<p>Create a Mueller matrix from the given Jones matrix.</p>
<pre><code>mueller(J1::JonesMatrix, J2::JonesMatrix)
</code></pre>

<p>Create a Mueller matrix from the two Jones matrices.</p>
<h3 id="polcal_makesquare">polcal_makesquare</h3>
<pre><code>polcal_makesquare(data, flags, ant1, ant2)
</code></pre>

<p>Pack the data into a square Hermitian matrix where each element is a Jones matrix.</p>
<p>Compare this to the regular complex gain calibration where each element is a complex scalar.</p>
<p>The packing order is:</p>
<pre><code>11 12 13
21 22 23
31 32 33
         .
           .
             .
</code></pre>

<h3 id="polcal_step">polcal_step</h3>
<pre><code>polcal_step(jones,data,model) -&gt; step
</code></pre>

<p>Given the <code>data</code> and <code>model</code> visibilities, and the current guess for the Jones matrices (<code>jones</code>), solve for <code>step</code> such that the new value of the Jones matrices is <code>jones+step</code>.</p>
<h3 id="rkstep">rkstep</h3>
<p>Take a Runge-Kutta step. * <code>step(x,args...)</code> must return the list of steps to take from the given location <code>x</code> * <code>rk</code> is the order of the Runge-Kutta method to use (eg. <code>RK4</code>) * <code>x</code> is the starting location * <code>args</code> is simply passed on as the second argument to <code>step</code></p>
<h3 id="scalar_makesquare">scalar_makesquare</h3>
<pre><code>scalar_makesquare(data, flags, ant1, ant2)
</code></pre>

<p>Pack the data into a square Hermitian matrix such that the data is ordered as follows:</p>
<pre><code>x₁x₁ x₁y₁ x₁x₂ x₁y₂
y₁x₁ y₁y₁ y₁x₂ y₁y₂
x₂x₁ y₂y₁ y₂x₂ y₂y₂
y₂x₁ y₂y₁ y₂x₂ y₂y₂
                     .
                       .
                         .
</code></pre>

<p>Flagged correlations and autocorrelations are set to zero.</p>
<h3 id="stokes">stokes</h3>
<pre><code>stokes(correlations) -&gt; [I,Q,U,V]
</code></pre>

<p>Take the vector of correlations <code>[xx,xy,yx,yy]</code> and convert it to the Stokes parameters.</p>
<h3 id="utm_to_latlong">utm_to_latlong</h3>
<pre><code>utm_to_latlong(zone, easting, northing,
               hemisphere = north)
</code></pre>

<p>Convert the easting and northing (both in meters) to a latitude and longitude (both in degrees).</p>
<p>This function is entirely based on the <a href="https://en.wikipedia.org/w/index.php?title=Universal_Transverse_Mercator_coordinate_system&amp;oldid=683193579#Simplified_formulas">Universal Transverse Mercator coordinate system</a> Wikipedia page.</p>
<h3 id="write_ds9_regions">write_ds9_regions</h3>
<pre><code>write_ds9_regions(filename, sources::Vector{PointSource})
</code></pre>

<p>Write the list of sources to a DS9 region file. This file can then be loaded into DS9 to highlight sources within images.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../contributing/" class="btn btn-neutral float-right" title="Contributing"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../external/" class="btn btn-neutral" title="API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../external/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../contributing/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
