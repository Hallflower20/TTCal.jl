<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gain Calibration - TTCal</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Gain Calibration";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> TTCal</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Usage</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Gain Calibration</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#gain-calibration">Gain Calibration</a></li>
                
                    <li><a class="toctree-l4" href="#running-from-a-julia-script">Running from a Julia script</a></li>
                
                    <li><a class="toctree-l4" href="#running-from-the-command-line">Running from the command line</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../polcal/">Polarization Calibration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ampcal/">Amplitude Calibration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sources/">Sky Models</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developer Documentation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../external/">API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../internal/">Internal Documentation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../contributing/">Contributing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../docs/">Building this Website</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">TTCal</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Usage &raquo;</li>
        
      
    
    <li>Gain Calibration</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mweastwood/TTCal.jl" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="gain-calibration">Gain Calibration</h2>
<p>With this calibration TTCal will solve for one complex gain (amplitude and phase)
per antenna polarization per frequency channel. That is for complex $g_i$ and
$i$, $j$ labeling the pair of antennas composing the baseline, TTCal seeks to minimize</p>
<p>
<script type="math/tex; mode=display">
    \sum_{i,j} \left\| V_{i,j} - g_i g_j^* M_{i,j} \right\|^2
</script>
</p>
<p>where $V_{i,j}$ is the measured visibility and $M_{i,j}$ is the model visibility
measured on the baseline $i$, $j$.</p>
<p>TTCal uses the iterative routine independently described by
<a href="http://adsabs.harvard.edu/abs/2008ISTSP...2..707M">Mitchell et al. 2008</a> and
<a href="http://adsabs.harvard.edu/abs/2014A%26A...571A..97S">Salvini &amp; Wijnholds 2014</a>
to solve for the complex gains.</p>
<p>For more information on defining a sky model see <a href="../sources/">Sky Models</a>.</p>
<p>TTCal will flag frequency channels that do not converge within the specified maximum
number of iterations. However, TTCal will not attempt to identify bad antennas
that may be poisoning the calibration. These antennas must be flagged ahead of
time.</p>
<p><em>TTCal assumes that the measurement set contains all baselines, multiple
frequency channels, but only a single integration.</em></p>
<h3 id="running-from-a-julia-script">Running from a Julia script</h3>
<pre><code class="julia">using TTCal
ms      = MeasurementSet(&quot;data.ms&quot;)
sources = readsources(&quot;sources.json&quot;)
beam    = TTCal.SineBeam()
cal = gaincal(ms, sources, beam, maxiter = 20, tolerance = 1e-3)
applycal!(ms, cal, force_imaging_columns = true)
unlock(ms)
</code></pre>

<h3 id="running-from-the-command-line">Running from the command line</h3>
<p>For a list of all available options, run:</p>
<pre><code>ttcal.jl gaincal --help
</code></pre>

<p>To calibrate a standard OVRO LWA dataset:</p>
<pre><code>ttcal.jl gaincal --input data.ms --output calibration.jld --sources sources.json
ttcal.jl applycal --input data.ms --calibration calibration.jld
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../polcal/" class="btn btn-neutral float-right" title="Polarization Calibration"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../polcal/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
